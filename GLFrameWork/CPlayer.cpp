//------------------------------------------------------------------------------
//
// プレイヤー [CPlayer.cpp]
// Author : AT-13A-273 Shinnosuke Munakata
//
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
// ヘッダインクルード
//------------------------------------------------------------------------------
#include <math.h>

#include "main.h"
#include "CPlayer.h"
#include "Keyboard.h"
#include "Camera.h"

//------------------------------------------------------------------------------
// コンストラクタ
//------------------------------------------------------------------------------
// 引数
//  なし
//------------------------------------------------------------------------------
CPlayer::CPlayer():CModel()
{
	Speed = 2.0f;
}

//------------------------------------------------------------------------------
// デストラクタ
//------------------------------------------------------------------------------
// 引数
//  なし
//------------------------------------------------------------------------------
CPlayer::~CPlayer()
{

}

//------------------------------------------------------------------------------
// 初期化
//------------------------------------------------------------------------------
// 引数
//  なし
// 戻り値
//  なし
//------------------------------------------------------------------------------
void CPlayer::Init(void)
{
	int a = 0;
	a++;

	CModel::Init();
}

//------------------------------------------------------------------------------
// 更新
//------------------------------------------------------------------------------
// 引数
//  なし
// 戻り値
//  なし
//------------------------------------------------------------------------------
void CPlayer::Update()
{
	VECTOR3 rot = VECTOR3(0.0f, 0.0f, 0.0f);

	// 移動
	// 上
	if(CKeyboard::GetPress(DIK_W))
	{
		Movement.x += sinf(_Rot.y) * Speed;
		Movement.z += cosf(_Rot.y) * Speed;
	}

	// 下
	else if (CKeyboard::GetPress(DIK_S))
	{
		Movement.x -= sinf(_Rot.y) * Speed;
		Movement.z -= cosf(_Rot.y) * Speed;
	}

	// 左
	if(CKeyboard::GetPress(DIK_A))
	{
		rot.y += 3.0f;
	}

	// 右
	else if(CKeyboard::GetPress(DIK_D))
	{
		rot.y -= 3.0f;
	}

	// キャラクターの回転
	_Rot += rot;

	// 値の丸め込み
	if(_Rot.y > 360.0f)
	{
		_Rot.y -= 2 * 360.0f;
	}
	else if (_Rot.y < -360.0f)
	{
		_Rot.y += 2 * 360.0f;
	}

	// キャラクターの移動
	_Pos += Movement;

	// 減速
	Movement *= 0.95f;
}

//------------------------------------------------------------------------------
// 
//------------------------------------------------------------------------------
// 引数
//  なし
// 戻り値
//  なし
//------------------------------------------------------------------------------
CPlayer* CPlayer::Create(int id,const VECTOR3& pos)
{
	CPlayer* model = new CPlayer;
	if (model == nullptr){ return nullptr; }

	model->ModelID = id;
	model->_Pos = pos;
	model->Init();

	return model;
}

//------------------------------------------------------------------------------
// EOF